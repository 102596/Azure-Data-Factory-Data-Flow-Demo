{
	"name": "metadata_mapping",
	"properties": {
		"sources": [
			{
				"dataset": {
					"referenceName": "genericSource",
					"type": "DatasetReference"
				},
				"name": "genericSource",
				"script": "source(output(\n\t\tProp_0 as string,\n\t\tProp_1 as string,\n\t\tProp_2 as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> genericSource"
			},
			{
				"dataset": {
					"referenceName": "mappingLookup",
					"type": "DatasetReference"
				},
				"name": "mappingLookup",
				"script": "source(output(\n\t\toldname as string,\n\t\tnewname as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> mappingLookup"
			}
		],
		"sinks": [
			{
				"dataset": {
					"referenceName": "others",
					"type": "DatasetReference"
				},
				"name": "sink1",
				"script": "Join1 sink(mapColumn(\n\t\tnewname\n\t),\n\tsaveMode:'overwrite') ~> sink1"
			}
		],
		"transformations": [
			{
				"name": "Join1",
				"script": "genericSource, mappingLookup join(Prop_0 == oldname || Prop_1 == oldname || Prop_2 == oldname,\n\tjoinType:'cross',\n\tbroadcast: 'none')~> Join1"
			}
		]
	}
}